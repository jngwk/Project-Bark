package dao;

import javax.servlet.ServletContext;

import dto.UserDTO;
import utils.JDBConnect;

public class UserDAO extends JDBConnect{
	
	public UserDAO(ServletContext application) {
		super(application);
	}
	
	public int login(String id, String pwd) {
		String sql = "SELECT pwd FROM user WHERE id = ?";
		try {
			pstmt = conn.prepareStatement(sql);
			pstmt.setString(1, id);
			rs = pstmt.executeQuery();
			if(rs.next()) {
				if(rs.getString("pwd").equals(pwd)) {
					// 로그인 정보가 일치함
					return 1;
				}
				else {
					// 로그인 정보가 일치하지 않음
					return 0;
				}
			}
			// 로그인 정보가 존재하지 않음
			return -1;
		}catch (Exception e) {
			System.out.println("로그인 에러: " + e.getMessage());
			// 데이터베이스 오류
			
		}
		// 데이터베이스 오류
		return -2;
	}
	
	public UserDTO getUser(String id) {
		String sql = "SELECT * FROM user WHERE id = ?";
		try {
			pstmt = conn.prepareStatement(sql);
			pstmt.setString(1, id);
			rs = pstmt.executeQuery();
			rs.next();
			UserDTO newUser = new UserDTO();
			newUser.setId(id);
			newUser.setPwd(rs.getString("pwd"));
			newUser.setName(rs.getString("name"));
			newUser.setPhone(rs.getString("phone"));
			newUser.setEmail(rs.getString("email"));
			newUser.setAddr(rs.getString("addr"));
			newUser.setAddrDetail(rs.getString("addrDetail"));
			newUser.setPostcode(rs.getInt("postcode"));
			newUser.setBank(rs.getString("bank"));
			newUser.setBankAcc(rs.getString("bankAcc"));
			newUser.setRegDate(rs.getDate("regDate"));
			newUser.setType(rs.getInt("type"));
			return newUser;
			
		}catch (Exception e) {
			System.out.println("유저 정보 회수 에러: " + e.getMessage());
		}
		return null;
	}

	
	
}
